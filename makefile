##################################################################
#
# general makefile for c/c++ project
#
# @chuanjiong
#
##################################################################

#-----------------------------------------------------------------
# user configuration
#-----------------------------------------------------------------

TARGET   := junity

SRCDIRS  := ./ ./src

MODULES  := ./jlib ./jmm ./jpcm ./jpic

#-----------------------------------------------------------------
# system information
#-----------------------------------------------------------------

SYSTEM    = $(shell uname -s)

ifeq ($(SYSTEM), Linux)
MINGW32   = 0
#ubuntu -> echo
#redhat -> echo -e
ECHO      = echo
else
MINGW32   = 1
ECHO      = echo -e
endif

#-----------------------------------------------------------------
# clear variable
#-----------------------------------------------------------------

CFLAGS   :=
CXXFLAGS :=
LDFLAGS  :=

#-----------------------------------------------------------------
# set variable
#-----------------------------------------------------------------

CXX       = g++
CC        = gcc

#-----------------------------------------------------------------
# config this part for c project
#-----------------------------------------------------------------

CFLAGS   += -Wall -g

CFLAGS   += -I./ -I./inc

ifeq ($(MINGW32), 1)
CFLAGS   += -DMINGW32
endif

# svn version
CFLAGS   += -D'SVN_VER="$(shell svn info | grep Revision)"'

#-----------------------------------------------------------------
# config this part for c++ project
#-----------------------------------------------------------------

CXXFLAGS += $(CFLAGS)

#-----------------------------------------------------------------
# linker config
#-----------------------------------------------------------------

#-----------------------------------------------------------------
# sub makefile
#-----------------------------------------------------------------

SUBMK     = $(foreach dir, $(MODULES), $(dir)/sub.mk)
-include $(SUBMK)

#-----------------------------------------------------------------
# common rules
#-----------------------------------------------------------------

include rules.mk


